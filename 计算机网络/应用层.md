# 应用层


## http和https的区别
1. http与https都是应用层的协议 区别是https需要向CA 申请证书，极少免费
2. https使用的端口号是443,http的端口是80
3. https是基于SSL的加密可靠传输，而http属于明文传输


## 一次https连接是怎样建立的，为什么更加安全 


    知识要点：https是基于TLS协议的，而这个协议分为两层，一层是TLS记录协议，一个是TLS握手。记录协议位于TCP的上层，负责数据的加密、压缩、封装等；握手协议是在记录协议上层，主要作用是在传输数据之前，通讯双方进行身份验证、协商加密算法、交换密钥等。
        
      PKI: public key infrastructure，公开密钥基础设施。权威的第三方认证机构CA是PKI的核心，CA负责核实公钥的拥有者的信息，并为其颁发证书，同时能够为使用者提供证书验证服务。申请者向CA提交申请证书相关信息：公钥、域名、证书请求文件.cer等。CA验证申请者的信息是否真实以及合法.当通过审核之后，CA 向申请者颁发证书，证书内容包含明文信息和签名信息，明文信息包含证书颁发机构、证书有效日期、域名、申请者相关信息及申请者公钥等。签名使用CA私钥进行加密的明文信息

1. 首先假设有两端，客户端与服务器端。客户端在第一步的时候将自己支持的对称加密算法、非对称加密算法、摘要算法以及一个随机数发送给服务器端
2. 服务器端选择一种非对称加密算法（RSA）,一个对称加密算法（AES），和MAC算法（鉴别完整性）。生成一个含有公钥、自己签名的证书（其中证书内容里面的申请者信息与公钥匙申请者提供的，而数字签名是由CA机构对证书内容进行一个hash加密）
3. 客户端收到这个证书之后，需要验证对方是不是真正的服务器。（验证证书本身的合法性。和颁发者的合法性，查找颁发者的证书及其合法性，这个过程是递归的）客户端计算产生随机数字MS，并用sever证书中的公钥对其加密
4. 服务器通过自己的私钥进行解密，得到MS,进而生成四个密钥，MA、MB EA EB，前两个表示会话MAC密钥，后两个表示会话加密密钥
5. 传输数据+mac（h(m,Ea)），再对这个数据进行EA加密。既做到了加密，也做到了完整性检验，因为篡改之后的h(m’,Ea)是不一样的。接受方收到m之后，与Ea进行一次hash操作，看与收到的mac是否一致

